# ТЕХНИЧЕСКОЕ ЗАДАНИЕ
## на разработку веб-приложения "Умный дом" (Smart Home)

---

## 1. ОБЩИЕ СВЕДЕНИЯ

### 1.1. Наименование проекта
**Smart Home Application** — веб-приложение для управления устройствами умного дома.

### 1.2. Заказчик и разработчик
- **Заказчик:** Учебный проект для дипломной работы
- **Разработчик:** Студент по специальности "Информационные системы и программирование"

### 1.3. Основание для разработки
Дипломный проект по специальности 09.02.07 "Информационные системы и программирование".

### 1.4. Сроки разработки
- Начало: 1 февраля 2026 г.
- Окончание: 1 марта 2026 г.

---

## 2. НАЗНАЧЕНИЕ И ЦЕЛИ РАЗРАБОТКИ

### 2.1. Назначение системы
Веб-приложение предназначено для:
- Централизованного управления устройствами умного дома
- Мониторинга состояния устройств и параметров среды
- Визуализации данных с датчиков
- Управления сценариями и автоматизацией

### 2.2. Цели разработки
1. Создание удобного интерфейса для управления умным домом
2. Обеспечение безопасной аутентификации пользователей
3. Интеграция с внешними API (погода, OAuth-провайдеры)
4. Поддержка многоязычности и тем оформления
5. Адаптивный дизайн для мобильных устройств

### 2.3. Область применения
- Частные дома и квартиры
- Учебные заведения (демонстрация возможностей)
- Прототипирование IoT-решений

---

## 3. ТРЕБОВАНИЯ К ФУНКЦИОНАЛУ

### 3.1. Функциональные требования

#### 3.1.1. Подсистема аутентификации и авторизации

| ID | Функция | Описание |
|----|---------|----------|
| AUTH-01 | Регистрация | Создание аккаунта с email и паролем |
| AUTH-02 | Подтверждение email | 6-значный код для верификации |
| AUTH-03 | Вход | Аутентификация по email/паролю |
| AUTH-04 | OAuth | Вход через Google и GitHub |
| AUTH-05 | Восстановление пароля | Сброс по коду из email |
| AUTH-06 | JWT-сессии | Токен действителен 7 дней |
| AUTH-07 | Управление профилем | Редактирование данных, аватар |
| AUTH-08 | Удаление аккаунта | Полное удаление данных |

#### 3.1.2. Управление устройствами

| ID | Функция | Описание |
|----|---------|----------|
| DEV-01 | Просмотр устройств | Список всех устройств пользователя |
| DEV-02 | Добавление устройства | Создание нового устройства |
| DEV-03 | Редактирование | Изменение параметров устройства |
| DEV-04 | Удаление устройства | Удаление из системы |
| DEV-05 | Включение/выключение | Управление состоянием |
| DEV-06 | Избранное | Добавление в избранное |
| DEV-07 | Фильтрация по комнатам | Группировка по помещениям |
| DEV-08 | Типы устройств | 8 типов: свет, термостат, камера, замок, динамик, TV, розетка, датчик |

#### 3.1.3. Мониторинг состояний

| ID | Функция | Описание |
|----|---------|----------|
| STAT-01 | Погода | Текущая погода и прогноз на 3 дня |
| STAT-02 | Температура комнат | Отображение с датчиков |
| STAT-03 | Качество воздуха | AQI, CO₂, PM2.5 |
| STAT-04 | Энергопотребление | Статистика потребления |
| STAT-05 | Безопасность | Статус замков, камер, датчиков |
| STAT-06 | Системная информация | Uptime, версия, статус устройств |

#### 3.1.4. Дополнительные функции

| ID | Функция | Описание |
|----|---------|----------|
| EXT-01 | Логи действий | История операций пользователя |
| EXT-02 | Темы оформления | Светлая и тёмная тема |
| EXT-03 | Многоязычность | Русский и английский |
| EXT-04 | Аватарки | Загрузка и удаление фото |
| EXT-05 | Адаптивность | Поддержка мобильных устройств |

---

### 3.2. Нефункциональные требования

#### 3.2.1. Требования к производительности

| Параметр | Значение |
|----------|----------|
| Время загрузки страницы | < 2 секунд |
| Время отклика API | < 500 мс |
| Поддержка пользователей | До 1000 одновременных |
| Размер базы данных | До 100 МБ |

#### 3.2.2. Требования к безопасности

| Требование | Реализация |
|------------|------------|
| Хеширование паролей | bcrypt с солью |
| Защита токенов | JWT с expiration |
| Валидация данных | На клиенте и сервере |
| CORS | Ограничение доменов |
| HTTPS | Обязательно для production |

#### 3.2.3. Требования к интерфейсу

- **Дизайн:** Современный, минималистичный
- **Цветовая схема:** Синий (#60a5fa, #3b82f6), зелёный (#10b981), красный (#ef4444)
- **Шрифты:** Системные (sans-serif)
- **Анимации:** Плавные переходы (0.2-0.3s)
- **Адаптивность:** Mobile-first подход

---

## 4. ТЕХНИЧЕСКИЕ ТРЕБОВАНИЯ

### 4.1. Технологический стек

#### Frontend
| Компонент | Технология | Версия |
|-----------|------------|--------|
| Фреймворк | Vue.js | 3.3+ |
| State management | Pinia | 2.1+ |
| Роутинг | Vue Router | 4.2+ |
| HTTP-клиент | Axios | 1.13+ |
| Сборщик | Vite | 4.4+ |

#### Backend
| Компонент | Технология | Версия |
|-----------|------------|--------|
| Платформа | Node.js | 18+ |
| Фреймворк | Express | 4.18+ |
| Аутентификация | JWT | 9.0+ |
| Хеширование | bcryptjs | 2.4+ |
| Загрузка файлов | Multer | 2.0+ |
| Email | Nodemailer | 8.0+ |

#### База данных
| Компонент | Технология |
|-----------|------------|
| Тип | JSON-файл |
| Расположение | /server/database/db.json |

### 4.2. Требования к окружению

#### Разработка
- Node.js >= 18.0
- npm >= 9.0
- Браузер: Chrome, Firefox, Edge (последние версии)

#### Production
- Node.js >= 18.0
- PM2 или аналог для процесса
- Nginx для раздачи статики
- HTTPS сертификат

### 4.3. Структура проекта

```
smart-home-app/
├── src/                        # Frontend
│   ├── views/                  # Страницы
│   │   ├── LoginView.vue
│   │   ├── RegisterView.vue
│   │   ├── ForgotPasswordView.vue
│   │   ├── DashboardView.vue
│   │   ├── DevicesView.vue
│   │   ├── ProfileView.vue
│   │   └── StatusView.vue
│   ├── components/             # Компоненты
│   │   ├── Navbar.vue
│   │   ├── ThemeToggle.vue
│   │   └── LanguageSelector.vue
│   ├── stores/                 # Pinia stores
│   │   ├── auth.js
│   │   ├── devices.js
│   │   ├── activityLogs.js
│   │   ├── theme.js
│   │   └── i18n.js
│   ├── router/
│   │   └── index.js
│   ├── services/
│   │   └── api.js
│   ├── assets/
│   ├── App.vue
│   └── main.js
├── server/                     # Backend
│   ├── routes/
│   │   ├── auth.js
│   │   ├── devices.js
│   │   ├── oauth.js
│   │   ├── weather.js
│   │   └── activity-logs.js
│   ├── middleware/
│   │   └── auth.js
│   ├── config/
│   │   └── database.js
│   ├── services/
│   │   └── email.js
│   ├── database/
│   │   └── db.json
│   ├── uploads/
│   └── index.js
├── .env                        # Переменные окружения
├── .env.example                # Пример переменных
├── package.json
├── vite.config.js
└── README.md
```

---

## 5. ТРЕБОВАНИЯ К ДАННЫМ

### 5.1. Структура базы данных

#### Пользователи (users)
```json
{
  "id": number,
  "name": string,
  "email": string,
  "password": string (hashed),
  "email_verified": boolean,
  "verification_code": string,
  "oauth_provider": string,
  "oauth_id": string,
  "avatar": string,
  "created_at": ISO date
}
```

#### Устройства (devices)
```json
{
  "id": number,
  "user_id": number,
  "name": string,
  "type": string,
  "room": string,
  "is_on": boolean,
  "is_favorite": boolean,
  "properties": object,
  "created_at": ISO date
}
```

#### Логи действий (activityLogs)
```json
{
  "id": number,
  "user_id": number,
  "action": string,
  "details": object,
  "created_at": ISO date
}
```

### 5.2. Типы устройств и свойства

| Тип | Свойства |
|-----|----------|
| light | - |
| thermostat | temperature, target_temperature |
| camera | - |
| lock | locked |
| speaker | - |
| tv | - |
| socket | - |
| sensor | temperature |

---

## 6. API СПЕЦИФИКАЦИЯ

### 6.1. Endpoints

#### Аутентификация
| Метод | Endpoint | Описание |
|-------|----------|----------|
| POST | /api/auth/register | Регистрация |
| POST | /api/auth/verify | Подтверждение email |
| POST | /api/auth/login | Вход |
| POST | /api/auth/forgot-password | Запрос сброса пароля |
| POST | /api/auth/reset-password | Сброс пароля |
| GET | /api/auth/me | Текущий пользователь |
| PUT | /api/auth/profile | Обновление профиля |
| PUT | /api/auth/password | Смена пароля |
| POST | /api/auth/avatar | Загрузка аватара |
| DELETE | /api/auth/avatar | Удаление аватара |
| DELETE | /api/auth/account | Удаление аккаунта |

#### Устройства
| Метод | Endpoint | Описание |
|-------|----------|----------|
| GET | /api/devices | Список устройств |
| GET | /api/devices/:id | Одно устройство |
| POST | /api/devices | Создать устройство |
| PUT | /api/devices/:id | Обновить устройство |
| DELETE | /api/devices/:id | Удалить устройство |

#### OAuth
| Метод | Endpoint | Описание |
|-------|----------|----------|
| GET | /api/oauth/github | Вход через GitHub |
| GET | /api/oauth/github/callback | Callback GitHub |
| GET | /api/oauth/google | Вход через Google |
| GET | /api/oauth/google/callback | Callback Google |

#### Погода
| Метод | Endpoint | Описание |
|-------|----------|----------|
| GET | /api/weather?city=... | Данные о погоде |

#### Логи
| Метод | Endpoint | Описание |
|-------|----------|----------|
| GET | /api/activity-logs | История действий |

### 6.2. Формат запросов

#### Заголовок авторизации
```
Authorization: Bearer <jwt_token>
```

#### Пример запроса (создание устройства)
```json
POST /api/devices
{
  "name": "Лампа в гостиной",
  "type": "light",
  "room": "Гостиная"
}
```

#### Пример ответа
```json
{
  "device": {
    "id": 1,
    "name": "Лампа в гостиной",
    "type": "light",
    "room": "Гостиная",
    "is_on": false,
    "is_favorite": false,
    "properties": {},
    "created_at": "2026-02-21T10:00:00.000Z"
  }
}
```

---

## 7. ИНТЕРФЕЙС ПОЛЬЗОВАТЕЛЯ

### 7.1. Страницы приложения

#### Страница входа (Login)
- Форма входа (email, пароль)
- Ссылка на регистрацию
- Ссылка на восстановление пароля
- Кнопки OAuth (Google, GitHub)

#### Страница регистрации (Register)
- Форма регистрации (имя, email, пароль)
- Валидация пароля (минимум 8 символов, цифра, спецсимвол)
- Подтверждение email (6-значный код)

#### Dashboard (Главная)
- Приветствие пользователя
- Статистика устройств
- Фильтры по комнатам
- Список устройств (карточки)
- Управление устройствами (вкл/выкл, редактирование, удаление)
- Модальное окно логов действий

#### Устройства (Devices)
- Полный список устройств
- Табличное представление
- Фильтры и сортировка
- CRUD операции

#### Состояния (Status)
- Погода (текущая + прогноз)
- Температура по комнатам
- Качество воздуха (AQI)
- Энергопотребление
- Безопасность
- Системная информация

#### Профиль (Profile)
- Аватар пользователя
- Личные данные
- Статистика
- Настройки безопасности
- Уведомления
- Удаление аккаунта

### 7.2. Компоненты

#### Navbar
- Логотип
- Навигационные ссылки
- Переключатель темы
- Переключатель языка
- Кнопка выхода

#### ThemeToggle
- Иконка солнца/луны
- Переключение light/dark
- Сохранение в localStorage

#### LanguageSelector
- Выпадающий список
- Флаги стран
- Поддержка: en, ru

---

## 8. ЭТАПЫ РАЗРАБОТКИ

| Этап | Описание | Срок |
|------|----------|------|
| 1 | Проектирование архитектуры | 1-3 февраля |
| 2 | Настройка окружения | 4-5 февраля |
| 3 | Разработка backend (auth, devices) | 6-12 февраля |
| 4 | Разработка frontend (базовые страницы) | 13-18 февраля |
| 5 | Интеграция API | 19-21 февраля |
| 6 | Дополнительные функции (i18n, темы) | 22-24 февраля |
| 7 | Тестирование и отладка | 25-26 февраля |
| 8 | Документирование | 27-28 февраля |

---

## 9. ТРЕБОВАНИЯ К ТЕСТИРОВАНИЮ

### 9.1. Виды тестирования

| Вид | Описание | Инструменты |
|-----|----------|-------------|
| Unit-тесты | Тестирование функций | Vitest |
| Integration | Тестирование API | Supertest |
| E2E | Сквозное тестирование | Playwright |
| Ручное | Проверка UX | - |

### 9.2. Критерии приёмки

- Все функции работают согласно требованиям
- Нет критических ошибок
- Время загрузки < 2 секунд
- Успешная авторизация и CRUD операции
- Адаптивность на мобильных устройствах

---

## 10. ТРЕБОВАНИЯ К ДОКУМЕНТАЦИИ

### 10.1. Обязательная документация

1. **README.md** — описание проекта, быстрый старт
2. **TECHNICAL_SPECIFICATION.md** — данное ТЗ
3. **API.md** — документация API endpoints
4. **DEPLOYMENT.md** — инструкция по развёртыванию

### 10.2. Дополнительная документация

- Диаграммы (UML, ER)
- Скриншоты интерфейса
- Changelog версий

---

## 11. ПРИЛОЖЕНИЯ

### Приложение А. Переменные окружения

```env
# Порт сервера
PORT=3001

# JWT Secret
JWT_SECRET=your-secret-key-change-in-production

# Frontend URL
FRONTEND_URL=http://localhost:3000

# SMTP (для email)
SMTP_USER=your-email@yandex.ru
SMTP_PASS=your-app-password

# OAuth
GITHUB_CLIENT_ID=your-client-id
GITHUB_CLIENT_SECRET=your-client-secret
GOOGLE_CLIENT_ID=your-client-id
GOOGLE_CLIENT_SECRET=your-client-secret

# Weather API
OPENWEATHER_API_KEY=your-api-key
```

### Приложение Б. Примеры устройств

```json
{
  "light": { "name": "Лампа", "room": "Гостиная" },
  "thermostat": { "name": "Термостат", "room": "Спальня", "properties": { "temperature": 22 } },
  "lock": { "name": "Входной замок", "room": "Прихожая", "properties": { "locked": true } },
  "camera": { "name": "Камера во дворе", "room": "Двор" }
}
```

---

## 12. ЗАКЛЮЧЕНИЕ

Данное техническое задание описывает полный функционал веб-приложения "Умный дом". Реализация всех требований обеспечит создание современного, безопасного и удобного приложения для управления устройствами умного дома.

**Разработчик:** _________________ / _________________

**Дата:** "___" __________ 2026 г.
